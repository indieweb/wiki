https://indieweb.org/ActivityPub

{{stub}}

'''<dfn>[https://www.w3.org/TR/activitypub/ ActivityPub]</dfn>''' is a decentralized social networking protocol ([[W3C]] Recommendation) developed in the [[Social Web Working Group]] based on [[pump.io]] and [[ActivityStreams]]. Conceptually they were all preceded by [[OStatus]]. It was  briefly known as <dfn>ActivityPump</dfn> before being renamed to ActivityPub.

[[File:w3c-spec-REC.svg]]

== IndieWeb Examples ==
* {{pfefferle}} has built the ActivityPub plugin for [[WordPress]] which allows his WordPress sites to (at least partially) support the ActivityPub protocol so sites like [[Mastodon]] and other parts of the Fediverse view his sites as a federated member. 
* {{aaronpk}} - I have native ActivityPub support in my website so that it can be followed from people using compatible software. I turned that knowledge into a separate service that can be used to add ActivityPub to any website, the code is available as [https://github.com/aaronpk/Nautilus Nautilus] on GitHub.
* {{jgmac1106}} uses Mastodon Plugin for [[Known]] which enables syndication, and native ActivityPub support in [[Micro.blog]]:
** Added the Mastodon Plugin for [[Known]] to syndicate posts but also used [[Bridgy]] to create an instance of his blog at  @quickthoughts.jgregorymcverry.com@quickthoughts.jgregorymcverry.com.
** Uses the native ActivityPub support in [[Micro.blog]] which can be viewed @jgmac1106@stream.jgregorymcverry.com he can then send posts from his blog to his ActivityPub instance through [[Micro.blog]]
* {{jlelse}} has native ActivityPub support on his blog using a custom implementation, that sends [[JSON Feed]] updates to followers.

__TOC__

== Bridging ==

{{main|bridge#ActivityPub}}

=== ActivityPub Notifications to Webmention ===

Since Mastodon and other ActivityPub implementations often include Microformats on their permalinks, a shortcut for receiving comments from ActivityPub servers is to treat them as webmentions instead of doing the full Inbox processing normally required by ActivityPub.

When your ActivityPub inbox receives a notification:

* If <code>type</code> is <code>Create</code>
** and if <code>object.InReplyTo</code> is present and is a URL on your domain
*** then save <code>object.id</code> as "source"
*** save <code>object.InReplyTo</code> as "target"
*** send a webmention to your webmention endpoint with the source and target

Then your site's existing webmention handling will fetch and verify the ActivityPub source URL, and if there are Microformats on the page, will even look like a reply.

Example:
* Post permalink: https://aaronparecki.com/2018/07/01/9/
* Mastodon reply URL: https://mastodon.social/@aaronpk/100302258872089825

=== Sending an ActivityPub notification from an IndieWeb website ===

As more people and services in the IndieWeb build in support for ActivityPub, it's important to remember that competing communication options could happen. Here is a general top-level breakdown of sending an ActivityPub notification for a [[reply]] or [[like]].

The u-in-reply-to or u-like-of url will be referred to as the "targetUrl" below, and your post is referred to as the sourceUrl.

* Fetch the targetUrl via text/html, check for a [[webmention]] endpoint.
* If webmention endpoint exists, abort ActivityPub and send a [[webmention]] for sourceUrl to targetUrl
* If webmention endpoint does not exist, attempt to fetch the targetUrl as <code>application/activity+json</code>
** If targetUrl doesn't return JSON, targetUrl doesn't accept ActivityPub, abort.
** If targetUrl returns JSON, check for a top-level <code>@context</code> attribute. This can be an array or a string, check if it contains "<code>https://www.w3.org/ns/activitystreams</code>".
*** If targetUrl's JSON response does not return the right details, abort.
*** If targetUrl's JSON response returns the correct info, check the <code>attributedTo</code> attribute for the author's ActivityPub profile.
**** Fetch the author's ActivityPub profile url as <code>application/activity+json</code> and check top-level <code>inbox</code> attribute for the author's ActivityPub inbox endpoint.
**** Send an ActivityPub notification to the author's ActivityPub inbox endpoint.

==== Tips & Tricks for Sending ActivityPub notifications ====
* Mastodon requires that you include a "Mention" in the tags array, but you also need to include the person's <code>preferredUsername</code> in the post text to show it as a notification.
* Technically <code>attributedTo</code> can be an object, but this hasn't been seen in the wild yet.

== How To ==
(this section is a stub, please add links to How To articles for ActivityPub)
* Funkwhale’s [http://docs-funkwhale-funkwhale-549-music-federation-documentation.preview.funkwhale.audio/federation/index.html federation documentation] contains very clear examples of activities to be send around.
* [https://blog.joinmastodon.org/2018/06/how-to-implement-a-basic-activitypub-server/ How to Implement a Basic ActivityPub Server]

== IndieWebCamp Sessions ==
* [[2018/NYC/activitypub]]
(pretty sure there's been more sessions, e.g. re: Bridging that was brainstormed and developed at [[2017]] or [[2018]])

== Criticism ==
(this section needs organizing into discrete rational criticisms, even better if they can be filed as issues on the specs and moved to an "Issues" section instead)
* {{citation
| title = ActivityPub - one protocol to rule them all?
| url = https://schub.io/blog/2018/02/01/activitypub-one-protocol-to-rule-them-all.html
| author = Dennis Schubert
| published = 2018-02-01
| archiveurl = https://web.archive.org/web/20181208062036/https://schub.io/blog/2018/02/01/activitypub-one-protocol-to-rule-them-all.html
}}
** Response: {{citation
| title = ActivityPub? Well, it’s not that bad
| url = https://feneas.org/activitypub-well-its-not-that-bad/
| author = Michael Vogel
| published = 2019-01-09
| archiveurl = http://web.archive.org/web/20190209024932/https://feneas.org/activitypub-well-its-not-that-bad/
}}
* {{citation
| title = ActivityPub - Final thoughts, one year later
| url = https://schub.io/blog/2019/01/13/activitypub-final-thoughts-one-year-later.html
| author = Dennis Schubert
| published = 2019-01-13
| archiveurl = https://web.archive.org/web/20190202142206/https://schub.io/blog/2019/01/13/activitypub-final-thoughts-one-year-later.html
}}
* 2018-07-30 [http://beesbuzz.biz/blog/2535-ActivityPub-hot-take ActivityPub hot take] <blockquote>This isn’t creating a distributed network, this is creating a whole bunch of massive points of failure. And these failures grow exponentially as more failures happen. Its very nature also makes it so that it’s much more difficult for this data to be migrated; look at what happened when [[witches.town]] went down, or when scifi.fyi’s certificate expired [Ed.: for ~ a day https://scifi.fyi/@BrokenBiscuit/100426278316164570], and the effects this had on all other instances regardless of the users of those instances. And spinning up an instance is expensive, and that cost rises with the number of instances out there.</blockquote>
* 2018-08-07 Thread from author of [[litepub]] draft specification, provides background frustration and motivations for a variant protocol: https://pleroma.site/notice/2962026
** "activitypub is a crummy protocol, largely designed by committee, largely intended to make W3C brass happy by cargoculting even more of their crummy technology into it.<br><br>we need to fork this shit today and purge W3C from activitypub.  it's the only conclusion i keep coming to after trying to read their specs." [https://pleroma.site/users/kaniini @kaniini] August 7, 2018

== See Also ==
* https://activitypub.com/ which apparently redirects to https://activitypub.rocks/
* https://github.com/go-fed/presentations/tree/master/2018/go-activitypub-journey
* https://blog.joinmastodon.org/2018/07/how-to-make-friends-and-verify-requests/
* https://octodon.social/web/statuses/100527636732474823
* [[Bridgy Fed]]
* [https://wordpress.org/plugins/activitypub/ ActivityPub plugin for WordPress] from {{pfefferle}}
* [[CommonsPub]]
* https://twitter.com/tinysubversions/status/1204494753066209280
** "I just released a small ActivityPub debugging tool. It's hosted on @glitch and the idea is that an AP developer can simply remix the project and instantly have their own tiny AP server from which they can send arbitrary test messages.<br><br>https://tinysubversions.com/notes/activitypub-tool/" [https://tinysubversions.com @tinysubversions] December 10, 2019
* [https://moodle.com/news/moodlenet-what-is-a-federated-social-network/ MoodleNet: What is a federated social network?]
